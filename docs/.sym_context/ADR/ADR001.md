---
tags: [architecture, nix, flakes]
---

# ADR-001: Why Flakes over Channels

**Status:** Accepted
**Date:** 2026-01-04

## Context

NixOS offers two primary methods for managing system configuration:
1.  **Channels**: The traditional approach using `nix-channel` to subscribe to binary channels.
2.  **Flakes**: The modern approach using `flake.nix` with explicit, pinned inputs.

This repository needed a reproducibility and portability strategy.

## Decision

We use **Nix Flakes** as the primary configuration method.

## Consequences

**Positive:**
- **Reproducibility**: `flake.lock` pins exact git revisions for all inputs.
- **Portability**: The configuration can be cloned and built on any machine without channel setup.
- **Composability**: Easy to import modules from external flakes (e.g., Home Manager, Hyprland).
- **Modern Tooling**: `nix build`, `nix develop`, `nix flake check` provide a unified CLI.

**Negative:**
- **Experimental Status**: Flakes are still technically "experimental" (though widely adopted).
- **Learning Curve**: New users may find flake syntax unfamiliar.
- **CI Complexity**: Requires Nix installation with `--extra-experimental-features` in CI environments.

## Alternatives Considered

- **Channels Only**: Rejected because reproducibility is not guaranteed across machines.
- **Niv**: Rejected in favor of native flake lock management.
